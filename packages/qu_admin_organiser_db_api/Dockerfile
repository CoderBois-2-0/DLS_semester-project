# this image is meant to build the database using the migration files generated by drizzle
FROM mysql:8.0 AS qu_admin_organiser_db

ENV MYSQL_ROOT_USER='queue-up'
ENV MYSQL_ROOT_PASSWORD='queue-up'


FROM node:22-alpine

RUN apk add --no-cache gcompat
RUN apk add bash
RUN apk add pnpm

WORKDIR /app
COPY . .

RUN --mount=type=cache,id=pnpm,target=/pnpm/store pnpm --filter qu_admin_organiser_db_api install --frozen-lockfile
